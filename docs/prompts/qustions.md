  Clarifying Questions

  1. Problem/Goal: What specific problem does the AssignmentProcessor solve? Is it meant to automate the entire grading process from rubric generation through student feedback to summary creation?
  2. Pipeline Dependencies: You mentioned "correct sequence" - what is the exact order of pipeline execution? Does StudentWorkFeedbackPipeline depend on RubricPipeline completion? Does AssignmentSummaryPipeline need all
  StudentWorkFeedbackPipeline instances to complete first?
  3. Progress Updates: For "real-time progress updates for teachers":
    - How should progress be communicated (WebSocket, polling, SSE)?
    - What level of detail should be shown (overall percentage, current pipeline, individual student progress)?
    - Should teachers see estimated time remaining?
  4. Error Handling: What should happen when a pipeline fails?
    - Should the entire process stop, or continue with remaining pipelines?
    - Should there be retry logic for failed pipelines?
    - How should partial failures be handled (e.g., 3 out of 5 student feedback pipelines succeed)?
  5. Concurrency: Can multiple StudentWorkFeedbackPipeline instances run in parallel, or must they be sequential? What about performance considerations with many students?
  6. Result Aggregation: What specific data needs to be aggregated from each pipeline? What constitutes the "final result"?
  7. Assignment Status: What are the possible assignment statuses (e.g., processing, completed, failed)? When should each status be set?
  8. Integration Points: How does AssignmentProcessor receive its initial input (assignment ID, configuration)? Is it triggered by a background job, API call, or user action?
  9. Scope Boundaries: Are there any specific features this should NOT include (e.g., no direct UI rendering, no direct database updates)?

The assignment processor is meant to automate the entire grading process from rubric generation through student feedback to summary creation. The pipeline can be viewed in rubric_pipeline.rb, student_work_feedback_pipeline.rb, and assignment_summary_pipeline.rb. First we create a rubric based on the assignment information entered by the teacher in the assignment form. Then we generate student work feedback based on the assignment and rubric for each student submission. Finally we create an assignment summary based on the all student work feedback. Progress updates are shown to the user in the UI via turbo stream implementation handled by the broadcast service. Progress is calculated by the progress calculator and the progress broadcaster. Teachers should know how much of the assignment is completed and how much is left to be completed. For example, initially they should see that the rubric hasn't yet been created and the student work feedback hasn't been generated yet. Then they should see that the rubric has been created and the student work feedback is being generated. Then they should see that the student work feedback has been generated and the assignment summary is being created. Then they should see that the assignment summary has been created and the assignment is complete. If 3 out of 5 student works fail (after multiple retries attempted after either the api is overwhelmed or the response is not valid json), those student works should be marked as failed and the assignment should be marked as failed. Eventually we'll need to build a manual re-try, but for now that is not necessary. For now, let's do one llm request at a time. The pipelines have context objects that aggregate the results across each step. To review the assignment status see the StatusManagerFactory. The initial integration point is in the assignment processing job which is enqueued in the assignment creation process from the assignment creation service in the assignments controller. 